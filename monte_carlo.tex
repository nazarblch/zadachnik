\section{Метод Монте Карло}

\begin{problem}
Вычисление значения интеграла:

 \textbf{а)} Требуется вычислить с заданной точностью $\varepsilon $ и с заданной доверительной вероятностью $\gamma $ абсолютно сходящийся интеграл $J=\int _{\left[0,\; 1\right]^{m} }f\left(\vec{x}\right)d\vec{x} $. Считайте, что $\forall \; \; \vec{x}\in \left[0,\; 1\right]^{m} \to \left|f\left(\vec{x}\right)\right|\le 1$.

\noindent \textbf{Пояснение. }Введем случайный m-вектор $\vec{X}\in R\left(\left[0,\; 1\right]^{m} \right)$ и с.в. $\xi =f\left(\vec{X}\right)$. Тогда $M\xi =\int _{\left[0,\; 1\right]^{m} }f\left(\vec{x}\right)d\vec{x} =J$. Поэтому получаем оценку интеграла $\bar{J}_{n} =\frac{1}{n} \sum _{k=1}^{n}f\left(\vec{x}^{k} \right) $, где $\vec{x}^{k} $, $k=1,...,n$ -- повторная выборка значений случайного вектора $\vec{X}$ (т.е. все $\vec{x}^{k} $, $k=1,...,n$ -- независимы и одинаково распределены: также как и вектор $\vec{X}$). В задаче требуется оценить сверху число $n$ ($n\gg m$), начиная с которого $P\left(\left|J-\bar{J}_{n} \right|\le \varepsilon \right)\ge \gamma $.

\textbf{б) }Решите задачу из п. а) при дополнительном предположении липшецевости функции $f\left(\vec{x}\right)$, разбив единичный куб на $n=N^{m} $ одинаковых кубиков со стороной ${1\mathord{\left/ {\vphantom {1 N}} \right. \kern-\nulldelimiterspace} N} $, и используя оценку $\bar{J}_{n} =\frac{1}{n} \sum _{k=1}^{n}f\left(\vec{x}^{k} \right) $, где $\vec{x}^{k} $ -- имеет равномерное распределение в \textit{k}-м кубике.

\textbf{в) (метод выделения главной части, метод замены меры (метод существенной выборки), метод включения особенности в плотность) }Решите задачу п. а) не предполагая, что $f\left(\vec{x}\right)$ -- ограниченная функция на единичном кубе. Предложите способы уменьшения дисперсии полученной оценки интеграла. Как можно использовать информацию об особенностях функции $f\left(\vec{x}\right)$?

\end{problem}

\begin{problem}
Пусть с.в. $\eta _{1} $, $\eta _{2} $ имеют равномерное распределение на отрезке $\left[0,1\right]$. Докажите, что с.в. $X$ и $Y$: $X=\sqrt{-2\ln \eta _{1} } \cos \left(2\pi \eta _{2} \right)$, $Y=\sqrt{-2\ln \eta _{1} } \sin \left(2\pi \eta _{2} \right)$ -- независимые и одинаково распределенные: стандартно нормально ${\rm {\mathcal N}}\left(0,1\right)$.

\begin{ordre}
Покажите, что
\[f_{XY} (x,y)=\frac{1}{\sqrt{2\pi } } e^{-\frac{x^{2} }{2} } \frac{1}{\sqrt{2\pi } } e^{-\frac{y^{2} }{2} } =\frac{1}{2\pi } e^{-\frac{x^{2} +y^{2} }{2} } .\] 
Перейдите к полярным координатам, не забыв о якобиане замены переменных.
\end{ordre}

\end{problem}

\begin{problem}

Если $X$ -- с.в., имеющая стандартное нормальное распределение, то $X^{-2} $ имеет устойчивую плотность:
\[\frac{1}{\sqrt{2\pi } } e^{-\frac{1}{2x} } x^{-\frac{3}{2} } , x>0.\] 
Используя это, покажите, что если $X$ и $Y$ -- независимые нормально распределенные с.в. с нулевым математическим ожиданием и дисперсиями $\sigma _{1}^{2} $ и $\sigma _{2}^{2} $, то величина $Z=\frac{XY}{\sqrt{X^{2} +Y^{2} } } $ нормально распределена с дисперсией $\sigma _{3}^{2} $, такой, что $\frac{1}{\sigma _{3}^{2} } =\frac{1}{\sigma _{1}^{2} } +\frac{1}{\sigma _{2}^{2} } $ (Л.Шепп).

\end{problem}

\subsection{Генерация случайных величин}

\begin{problem}
Покажите, что если с.в. $\eta $ равномерно распределена на отрезке $\left[0,1\right]$, то с.в. $\xi =F^{-1} \left(\eta \right)$ имеет функцию распределения $F\left(x\right)$. Предполагается, что $F\left(x\right)$ непрерывна и строго монотонна. Как выглядит формула для моделирования с.в. из показательного распределения с функцией распределения $F\left(x\right)=\left(1-e^{-\lambda x} \right)I\left\{x>0\right\}$? (Стандартный способ моделирования с.в. -- метод обратной функции)
\end{problem}

\begin{problem}

Пусть $\xi $ распределена на $\left[0,1\right]$ с плотностью $f_{\xi } (x)$, представимой в виде степенного ряда $\sum _{k=0}^{\infty }a_{k} x^{k}  $ с $a_{k} \ge 0$. Положим $p_{k} ={a_{k} \mathord{\left/ {\vphantom {a_{k}  (k+1)}} \right. \kern-\nulldelimiterspace} (k+1)} $. Тогда $f_{\xi } (x)=\sum _{k=0}^{\infty }p_{k} \cdot (k+1)x^{k}  $. Примените метод суперпозиции для моделирования с.в. $\xi $.

\begin{ordre}
Метод суперпозиции:

\noindent 1) Разыгрывается значение дискретной с.в., принимающей значения $k=0,1,2,...$ с вероятностями $p_{k} $.

\noindent 2) Моделируется с.в. с функцией распределения $F_{k} (x)$ (например, методом обратной функции).

\end{ordre}

\end{problem}

\begin{problem}
(Теорема Бернштейна) 

\textbf{а)} С помощью неравенства Чебышёва установите следующий результат из анализа: 

\[
\forall \; \; f\in C\left[0,1\right]\to \left\| f_{n} -f\right\| _{C\left[0,1\right]} \xrightarrow[{n\to \infty }]{} 0,
\] 

\[
f_{n} \left(x\right)=\sum_{k=0}^{n}f\left(\frac{k}{n} \right) C_{n}^{k} x^{k} \left(1-x\right)^{n-k} 
\]

\textbf{б)} Исходя из предыдущей задачи и п. а) предложите способ генерирования распределения с.в. $\xi $, имеющей плотность $f_{\xi } \left(x\right)$ с финитным носителем, для определенности, пусть носителем будет отрезок $\left[0,1\right]$.
\end{problem}

\begin{problem}
Как с помощью с.в. $\xi $, равномерно распределенной на отрезке $\left[0,1\right]$ ($\xi \in R\left[0;1\right]$), и симметричной монетки построить с.в. $X$, имеющую плотность распределения $f_{X} (x)=\frac{1}{4} \left(\frac{1}{\sqrt{x} } +\frac{1}{\sqrt{1-x} } \right)$, $x\in \left[0,1\right]$?
\end{problem}

\begin{problem}
(Метод фон Неймана) 

Пусть с.в. $\xi $ распределена на отрезке$\left[a,b\right]$, причем ее плотность распределения ограничена: $\mathop{\max }\limits_{x\in \left[a;b\right]} f_{\xi } (x)=C<\infty $. Пусть с.в. $\eta _{1} $, $\eta _{2} $, \dots  -- независимы и равномерно распределены на $\left[0,1\right]$, $X_{i} =a+\left(b-a\right)\eta _{2i-1} $, $Y_{i} =C\eta _{2i} $, $i=1,2,...$, т.е. пары $\left(X_{i} ,Y_{i} \right)$ независимы и равномерно распределены в прямоугольнике $\left[a,b\right]\times \left[0,C\right]$. Обозначим через $\nu $ номер первой точки с координатами $\left(X_{i} ,Y_{i} \right)$, попавшей под график плотности $f_{\xi } (x)$, т.е. $\nu =\min \left\{i:\quad Y_{i} \le f_{\xi } (X_{i} )\right\}$. Положим $X_{\nu } =\sum _{n=1}^{\infty }X_{n} I\left\{\nu =n\right\} $.

\textbf{а)} Покажите, что с.в. $X_{\nu } $ распределена также как $\xi $.

\textbf{б)} Сколько в среднем точек $\left(X_{i} ,Y_{i} \right)$ потребуется «вбросить» в прямоугольник $\left[a,b\right]\times \left[0,C\right]$ для получения одного значения $\xi $?
\end{problem}

\subsection{Metropolis}

\subsection{Gibbs Sampler}

\subsection{Variational Inference}